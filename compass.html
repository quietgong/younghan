<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Device Orientation API</title>
</head>

<body>
  <h1>방향 감지</h1>
  <p id="orientation"></p>
  <script>
    let lastAlpha = null;

    async function main(){
      const status = document.getElementById("orientation");
      let alpha = await getAlpha();
      status.innerText = `alpha = ${alpha}`;
    }
    async function getAlpha() {
        return new Promise((resolve) => {
          if (window.DeviceOrientationEvent) {
            window.addEventListener('deviceorientation', (event) => {
              let alpha = event.alpha;
              if (lastAlpha !== null) {
                if (Math.abs(alpha - lastAlpha) > 180) {
                  if (alpha > lastAlpha) {
                    alpha -= 360;
                  } else {
                    alpha += 360;
                  }
                }
              }
              lastAlpha = alpha;
              resolve(alpha);
            }, { once: true });
          } else {
            resolve(null);
          }
        });
      }

    main();
  
  </script>
</body>

</html>